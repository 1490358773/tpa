#include "PointerAnalysis/External/ExternalRefTable.h"

using namespace llvm;

namespace tpa
{

RefEffect EffectTrait<RefEffect>::DefaultEffect = RefEffect::UnknownEffect;

void ExternalRefTable::initializeTable()
{
	table = {
		{"_IO_getc", RefEffect::NoEffect},
		{"_IO_putc", RefEffect::NoEffect},
		{"_exit", RefEffect::NoEffect},
		{"_setjmp", RefEffect::NoEffect},
		{"__assert_fail", RefEffect::NoEffect},
		{"abs", RefEffect::NoEffect},
		{"access", RefEffect::RefArg0},

		{"__isoc99_fscanf", RefEffect::RefArg0Arg1},
		{"fscanf", RefEffect::RefArg0Arg1},
		{"__isoc99_scanf", RefEffect::RefArg1},
		{"scanf", RefEffect::RefArg1},
		{"__isoc99_sscanf", RefEffect::RefArg0Arg1},
		{"sscanf", RefEffect::RefArg0Arg1},
		
		{"alarm", RefEffect::NoEffect},
		{"atexit", RefEffect::NoEffect},
		{"atof", RefEffect::RefArg0},
		{"atoi", RefEffect::RefArg0},
		{"atol", RefEffect::RefArg0},
		{"btowc", RefEffect::NoEffect},

		{"fclose", RefEffect::NoEffect},
		{"feof", RefEffect::NoEffect},
		{"ferror", RefEffect::NoEffect},
		{"fflush", RefEffect::NoEffect},
		{"fgetc", RefEffect::NoEffect},
		{"fputc", RefEffect::NoEffect},
		{"fputs", RefEffect::NoEffect},
		{"free", RefEffect::NoEffect},
		{"fseek", RefEffect::NoEffect},
		{"fseeko", RefEffect::NoEffect},
		{"fseeko64", RefEffect::NoEffect},
		
		{"fwrite", RefEffect::NoEffect},
		{"getchar", RefEffect::NoEffect},
		{"getegid", RefEffect::NoEffect},
		{"geteuid", RefEffect::NoEffect},
		{"getgid", RefEffect::NoEffect},
		{"getpgid", RefEffect::NoEffect},
		{"getpid", RefEffect::NoEffect},
		{"getppid", RefEffect::NoEffect},
		{"getsid", RefEffect::NoEffect},
		{"getuid", RefEffect::NoEffect},
		{"getresgid", RefEffect::NoEffect},
		{"getresuid", RefEffect::NoEffect},
		
		{"htonl", RefEffect::NoEffect},
		{"htons", RefEffect::NoEffect},
		
		{"isalnum", RefEffect::NoEffect},
		{"isalpha", RefEffect::NoEffect},
		{"isascii", RefEffect::NoEffect},
		{"isatty", RefEffect::NoEffect},
		{"isblank", RefEffect::NoEffect},
		{"iscntrl", RefEffect::NoEffect},
		{"isdigit", RefEffect::NoEffect},
		{"isgraph", RefEffect::NoEffect},
		{"islower", RefEffect::NoEffect},
		{"isprint", RefEffect::NoEffect},
		{"ispunct", RefEffect::NoEffect},
		{"isspace", RefEffect::NoEffect},
		{"isupper", RefEffect::NoEffect},
		{"iswalnum", RefEffect::NoEffect},
		{"iswalpha", RefEffect::NoEffect},
		{"iswctype", RefEffect::NoEffect},
		{"iswdigit", RefEffect::NoEffect},
		{"iswlower", RefEffect::NoEffect},
		{"iswspace", RefEffect::NoEffect},
		{"iswprint", RefEffect::NoEffect},
		{"iswupper", RefEffect::NoEffect},
		
		{"llvm.bswap.i16", RefEffect::NoEffect},
		{"llvm.bswap.i32", RefEffect::NoEffect},
		{"llvm.ctlz.i64", RefEffect::NoEffect},
		{"llvm.dbg.declare", RefEffect::NoEffect},
		{"llvm.dbg.value", RefEffect::NoEffect},
		{"llvm.lifetime.start", RefEffect::NoEffect},
		{"llvm.lifetime.end", RefEffect::NoEffect},
		{"llvm.stackrestore", RefEffect::NoEffect},
		{"llvm.trap", RefEffect::NoEffect},
		{"llvm.umul.with.overflow.i64", RefEffect::NoEffect},
		
		{"ntohl", RefEffect::NoEffect},
		{"ntohs", RefEffect::NoEffect},
		{"open", RefEffect::NoEffect},
		{"puts", RefEffect::NoEffect},
		{"srand", RefEffect::NoEffect},
		{"srandom", RefEffect::NoEffect},
		
		{"printf", RefEffect::RefAllArgs},
		{"fprintf", RefEffect::RefAfterArg0},
		{"sprintf", RefEffect::RefAfterArg0},
		{"snprintf", RefEffect::RefAfterArg0},
		
		{"strcasecmp", RefEffect::RefArg0Arg1},
		{"strcmp", RefEffect::RefArg0Arg1},
		{"strlen", RefEffect::RefArg0},
		{"strncasecmp", RefEffect::RefArg0Arg1},
		{"strncmp", RefEffect::RefArg0Arg1},
		{"syslog", RefEffect::RefAfterArg0},
		{"tolower", RefEffect::NoEffect},
		{"toupper", RefEffect::NoEffect},
		{"towlower", RefEffect::NoEffect},
		{"towupper", RefEffect::NoEffect},
		{"write", RefEffect::RefArg1Array},

		{"sin", RefEffect::NoEffect},
		{"cos", RefEffect::NoEffect},
		{"sinf", RefEffect::NoEffect},
		{"cosf", RefEffect::NoEffect},
		{"asin", RefEffect::NoEffect},
		{"acos", RefEffect::NoEffect},
		{"tan", RefEffect::NoEffect},
		{"atan", RefEffect::NoEffect},
		{"fabs", RefEffect::NoEffect},
		{"pow", RefEffect::NoEffect},
		{"floor", RefEffect::NoEffect},
		{"floorf", RefEffect::NoEffect},
		{"ceil", RefEffect::NoEffect},
		{"seed48", RefEffect::NoEffect},
		{"lrand48", RefEffect::NoEffect},
		{"abort", RefEffect::NoEffect},
		{"exit", RefEffect::NoEffect},
		{"log", RefEffect::NoEffect},
		{"log10", RefEffect::NoEffect},
		{"sqrt", RefEffect::NoEffect},
		{"sqrtf", RefEffect::NoEffect},
		{"exp", RefEffect::NoEffect},
		{"exp2", RefEffect::NoEffect},
		{"exp10", RefEffect::NoEffect},
		{"fabsf", RefEffect::NoEffect},
		{"hypot", RefEffect::NoEffect},
		{"rand", RefEffect::NoEffect},
		{"random", RefEffect::NoEffect},
		{"_ZdaPv", RefEffect::NoEffect},
		{"putchar", RefEffect::NoEffect},

		{"malloc", RefEffect::NoEffect},
		{"calloc", RefEffect::NoEffect},
		{"valloc", RefEffect::NoEffect},
		{"shmat", RefEffect::NoEffect},
		{"strdup", RefEffect::NoEffect},
		{"strndup", RefEffect::NoEffect},
		{"memalign", RefEffect::NoEffect},
		// These functions will implicitly call malloc
		{"ctime", RefEffect::NoEffect},
		{"fopen", RefEffect::NoEffect},
		{"getlogin", RefEffect::NoEffect},
		{"opendir", RefEffect::NoEffect},
		{"popen", RefEffect::NoEffect},
		{"tempnam", RefEffect::NoEffect},
		{"textdomain", RefEffect::NoEffect},
		{"tgetstr", RefEffect::NoEffect},
		{"ttyname", RefEffect::NoEffect},
		{"tmpfile", RefEffect::NoEffect},
		{"strerror", RefEffect::NoEffect},
		// The mangled name of C++ new operators
		{"_Znwj", RefEffect::NoEffect},
		{"_ZnwjRKSt9nothrow_t", RefEffect::NoEffect},
		{"_Znwm", RefEffect::NoEffect},
		{"_ZnwmRKSt9nothrow_t", RefEffect::NoEffect},
		{"_Znaj", RefEffect::NoEffect},
		{"_ZnajRKSt9nothrow_t", RefEffect::NoEffect},
		{"_Znam", RefEffect::NoEffect},
		{"_ZnamRKSt9nothrow_t", RefEffect::NoEffect},

		{"getcwd", RefEffect::NoEffect},
		{"mmap", RefEffect::NoEffect},
		{"realloc", RefEffect::NoEffect},
		{"strtok", RefEffect::NoEffect},
		{"strtok_r", RefEffect::NoEffect},

		{"fgets", RefEffect::NoEffect},
		{"gets", RefEffect::NoEffect},
		{"memchr", RefEffect::NoEffect},

		{"strcat", RefEffect::RefArg1},
		{"strncat", RefEffect::RefArg1},
		{"strcpy", RefEffect::RefArg1},
		{"strncpy", RefEffect::RefArg1},
		{"strchr", RefEffect::RefArg0},
		{"strrchr", RefEffect::RefArg0},
		{"strstr", RefEffect::RefArg0Arg1},
		{"strpbrk", RefEffect::RefArg0Arg1},
		{"strerror_r", RefEffect::NoEffect},

		{"strtod", RefEffect::RefArg0},
		{"strtof", RefEffect::RefArg0},
		{"strtol", RefEffect::RefArg0},
		{"strtold", RefEffect::RefArg0},
		{"strtoll", RefEffect::RefArg0},
		{"strtoul", RefEffect::RefArg0},
		
		{"freopen", RefEffect::RefArg0Arg1},
		

		{"bcopy", RefEffect::RefArg1Array},
		{"llvm.memcpy.i32", RefEffect::RefArg1Array},
		{"llvm.memcpy.p0i8.p0i8.i32", RefEffect::RefArg1Array},
		{"llvm.memcpy.i64", RefEffect::RefArg1Array},
		{"llvm.memcpy.p0i8.p0i8.i64", RefEffect::RefArg1Array},
		{"llvm.memmove.i32", RefEffect::RefArg1Array},
		{"llvm.memmove.p0i8.p0i8.i32", RefEffect::RefArg1Array},
		{"llvm.memmove.i64", RefEffect::RefArg1Array},
		{"llvm.memmove.p0i8.p0i8.i64", RefEffect::RefArg1Array},
		{"memccpy", RefEffect::RefArg1Array},
		{"memcpy", RefEffect::RefArg1Array},
		{"memmove", RefEffect::RefArg1Array},
		{"wmemcpy", RefEffect::RefArg1Array},

		{"memset", RefEffect::NoEffect},
		{"llvm.memset.p0i8.i64", RefEffect::NoEffect},
		{"llvm.memset.p0i8.i32", RefEffect::NoEffect},

		{"times", RefEffect::NoEffect},
		{"fread", RefEffect::NoEffect},
		{"qsort", RefEffect::NoEffect},
	};
}

}